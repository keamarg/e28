{"version":3,"sources":["webpack:///./src/components/pages/ProductPage.vue","webpack:///./src/features/favorite.js","webpack:///./src/components/pages/ProductPage.vue?714a"],"names":["id","class","productNotFound","to","product","detailed","addToCart","data-test","name","addConfirmation","user","isFavorite","removeFromFavorites","addToFavorites","favorite","productId","ref","favoriteId","computed","store","state","axios","get","value","then","response","data","length","post","product_id","user_id","success","delete","components","ShowProduct","props","type","String","setup","favoriteConfirmation","this","$store","getters","getProductById","products","methods","add","commit","count","setTimeout","createUser","registrationData","authenticated","errors","render"],"mappings":"oJACOA,GAAG,gB,2BAGwB,yB,YAS3B,eAAM,mB,SAEuBC,MAAM,S,+HAdxC,eAyBM,MAzBN,EAyBM,CAxBO,EAAAC,iB,iBAAX,eAGM,SAFJ,eAAkC,SAA/B,WAAQ,eAAG,EAAAF,IAAK,cAAW,GAC9B,eAA+D,GAAlDG,GAAG,aAAW,C,wBAAC,iBAAqB,C,eAEnC,EAAAC,S,iBAAhB,eAmBM,SAlBJ,eAGgB,GAFPA,QAAS,EAAAA,QACTC,UAAU,G,oBAEnB,eAEC,UAFY,QAAK,8BAAE,EAAAC,WAAA,EAAAA,UAAA,qBAAWC,YAAU,sBAAqB,gBAE7D,EACD,eAIa,QAJDC,KAAK,QAAM,C,wBACrB,iBAEM,CAFK,EAAAC,iB,iBAAX,eAEM,MAFN,EAEM,eADD,EAAAL,QAAQI,MAAO,4BACpB,I,gCAES,EAAAE,M,iBAAX,eAKM,SAJU,EAAAC,Y,iBAAd,eAES,U,MAFsB,QAAK,+BAAE,EAAAC,yBAAuB,6B,iBAG7D,eAAwE,U,MAApD,QAAK,+BAAE,EAAAC,oBAAkB,0B,yFCnBtC,SAASC,EAASC,GAG7B,IAAIJ,EAAaK,gBAAI,GACjBC,EAAaD,eAAI,MAGjBN,EAAOQ,gBAAS,WAChB,OAAOC,OAAMC,MAAMV,QAIvBW,OAAMC,IAAI,8BAAgCP,EAAY,YAAcL,EAAKa,MAAMvB,IAAIwB,MAAK,SAACC,GACjFA,EAASC,KAAKZ,SAASa,OAAS,IAGhCV,EAAWM,MAAQE,EAASC,KAAKZ,SAAS,GAAGd,GAC7CW,EAAWY,OAAQ,MAK3B,IAAMV,EAAiB,WACnBQ,OAAMO,KAAK,YAAa,CACpBC,WAAYd,EACZe,QAASpB,EAAKa,MAAMvB,KACrBwB,MAAK,SAACC,GACDA,EAASC,KAAKK,UACdpB,EAAWY,OAAQ,EACnBN,EAAWM,MAAQE,EAASC,KAAKZ,SAASd,QAMhDY,EAAsB,WACxBS,OAAMW,OAAO,aAAef,EAAWM,OAAOC,MAAK,SAACC,GAC5CA,EAASC,KAAKK,UACdpB,EAAWY,OAAQ,EACnBN,EAAWM,MAAQ,UAK/B,MAAO,CAAEZ,aAAYE,iBAAgBD,uBDb1B,OACbqB,WAAY,CAAE,eAAgBC,EAAA,MAC9BC,MAAO,CACLnC,GAAI,CACFoC,KAAMC,SAGVC,MAPa,SAOPH,GAAO,MACiDrB,EAC1DqB,EAAMnC,IADAW,EADG,EACHA,WAAYE,EADT,EACSA,eAAgBD,EADzB,EACyBA,oBAGpC,MAAO,CAAED,aAAYE,iBAAgBD,wBAEvCc,KAba,WAcX,MAAO,CACLjB,iBAAiB,EACjB8B,sBAAsB,IAG1BrB,SAAU,CACRR,KADQ,WAEN,OAAO8B,KAAKC,OAAOrB,MAAMV,MAE3BN,QAJQ,WAKN,OAAOoC,KAAKC,OAAOC,QAAQC,eAAeH,KAAKxC,KAEjDE,gBAPQ,WAQN,OAAuB,MAAhBsC,KAAKpC,SAEdwC,SAVQ,WAWN,OAAOJ,KAAKC,OAAOrB,MAAMwB,WAG7BC,QAAS,CACPvC,UADO,WACK,WACV,OAAKwC,IAAIN,KAAKpC,QAAQJ,IAEtBwC,KAAKC,OAAOM,OAAO,eAAgB,OAAKC,SAExCR,KAAK/B,iBAAkB,EACvBwC,YAAW,WACT,EAAKxC,iBAAkB,IACtB,MAELyC,WAXO,WAWM,WACX,OAAMtB,KAAK,WAAYY,KAAKW,kBAAkB3B,MAAK,SAACC,GAC9CA,EAASC,KAAK0B,cAChB,EAAKX,OAAOM,OAAO,UAAWtB,EAASC,KAAKhB,MAE5C,EAAK2C,OAAS5B,EAASC,KAAK2B,aEjFtC,EAAOC,OAASA,EAED","file":"js/chunk-2d215c67.99a1486a.js","sourcesContent":["<template>\n  <div id=\"product-page\">\n    <div v-if=\"productNotFound\">\n      <p>Product {{ id }} not found.</p>\n      <router-link to=\"/products\">Back to products page</router-link>\n    </div>\n    <div v-else-if=\"product\">\n      <show-product\n        v-bind:product=\"product\"\n        v-bind:detailed=\"true\"\n      ></show-product>\n      <button v-on:click=\"addToCart\" data-test=\"add-to-cart-button\">\n        Add to cart</button\n      ><br />\n      <transition name=\"fade\">\n        <div v-if=\"addConfirmation\" class=\"alert\">\n          {{ product.name }} was added to your cart!\n        </div>\n      </transition>\n      <div v-if=\"user\">\n        <button v-if=\"isFavorite\" v-on:click=\"removeFromFavorites()\">\n          Remove from favorites\n        </button>\n        <button v-else v-on:click=\"addToFavorites()\">❤ Add to favorites</button>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport ShowProduct from \"@/components/ShowProduct.vue\";\nimport { cart } from \"@/common/app.js\";\nimport { axios } from \"@/common/app.js\";\nimport favorite from \"@/features/favorite.js\";\n\nexport default {\n  components: { \"show-product\": ShowProduct },\n  props: {\n    id: {\n      type: String,\n    },\n  },\n  setup(props) {\n    const { isFavorite, addToFavorites, removeFromFavorites } = favorite(\n      props.id\n    );\n    return { isFavorite, addToFavorites, removeFromFavorites };\n  },\n  data() {\n    return {\n      addConfirmation: false,\n      favoriteConfirmation: false,\n    };\n  },\n  computed: {\n    user() {\n      return this.$store.state.user;\n    },\n    product() {\n      return this.$store.getters.getProductById(this.id);\n    },\n    productNotFound() {\n      return this.product == null;\n    },\n    products() {\n      return this.$store.state.products;\n    },\n  },\n  methods: {\n    addToCart() {\n      cart.add(this.product.id);\n\n      this.$store.commit(\"setCartCount\", cart.count());\n\n      this.addConfirmation = true;\n      setTimeout(() => {\n        this.addConfirmation = false;\n      }, 3000);\n    },\n    createUser() {\n      axios.post(\"register\", this.registrationData).then((response) => {\n        if (response.data.authenticated) {\n          this.$store.commit(\"setUser\", response.data.user);\n        } else {\n          this.errors = response.data.errors;\n        }\n      });\n    },\n  },\n};\n</script>\n  \n<style>\n</style>","import { ref, computed } from 'vue'\nimport { axios } from '@/common/app.js';\nimport { store } from '@/common/store.js';\n\nexport default function favorite(productId) {\n\n    // Reactive references\n    let isFavorite = ref(false);\n    let favoriteId = ref(null);\n\n    // Just like in our components, we’ll access our state via computed props \n    let user = computed(() => {\n        return store.state.user;\n    });\n\n    // Figure out if this product is a favorite by pinging the `favorite` “query” route\n    axios.get('/favorite/query?product_id=' + productId + '&user_id=' + user.value.id).then((response) => {\n        if (response.data.favorite.length > 0) {\n            // There should only ever be one unique match between a given user id \n            // and a given product id so we narrow the results down to [0]\n            favoriteId.value = response.data.favorite[0].id;\n            isFavorite.value = true;\n        }\n    });\n\n    // Method\n    const addToFavorites = () => {\n        axios.post('/favorite', {\n            product_id: productId,\n            user_id: user.value.id\n        }).then((response) => {\n            if (response.data.success) {\n                isFavorite.value = true;\n                favoriteId.value = response.data.favorite.id;\n            }\n        });\n    }\n\n    // Method\n    const removeFromFavorites = () => {\n        axios.delete('/favorite/' + favoriteId.value).then((response) => {\n            if (response.data.success) {\n                isFavorite.value = false;\n                favoriteId.value = null;\n            }\n        });\n    }\n\n    return { isFavorite, addToFavorites, removeFromFavorites }\n}\n","import { render } from \"./ProductPage.vue?vue&type=template&id=cd30d402\"\nimport script from \"./ProductPage.vue?vue&type=script&lang=js\"\nexport * from \"./ProductPage.vue?vue&type=script&lang=js\"\nscript.render = render\n\nexport default script"],"sourceRoot":""}